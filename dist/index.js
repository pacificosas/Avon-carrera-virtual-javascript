!function(){"use strict";var e="https://apps.pacificamello.com/avonUtilidades/api/v1/";const t=e=>({target:t})=>{const n=Array.from(t.querySelectorAll("option")).find((e=>e.value===t.value));e(n.getAttribute("data-id")||"",n)},n=e=>{const t=document.createElement("option");return t.value="",t.innerHTML=e,t},a=async(t,n,{fromId:a,country:l,defaultLabel:o}={})=>{try{const c=a?`fromId=${a}&country=${l}`:`country=${l}`,s=await fetch(`${e}geography/${n}?${c}`),i=(await s.json()).payload.map((e=>{const t=document.createElement("option");return t.value=e.name,t.innerHTML=e.name,t.setAttribute("data-id",e.id),t}));r(t,o),i.forEach((e=>t.append(e)))}catch(e){console.warm(e)}},r=(e,t)=>{e.innerHTML="",e.append(n(t))},l=e=>{e.forEach((e=>r(e.element,e.defaultLabel)))};var o=e=>`pacifica__${e}`;const c=async(t,n)=>{try{const a=await fetch(`${e}/representatives/${n}?code=${t}`),{payload:r}=await a.json();return r&&sessionStorage.setItem(o("rep"),JSON.stringify(r)),r}catch(e){console.warn(e)}};var s={getRep:c,getRepOnForm:({loading:e,err:t,country:n,form:a,input:r}={},l)=>{a.addEventListener("submit",(async a=>{a.preventDefault();const o=r.value;if(!o)return;e&&(e.style.display="block"),t&&(t.style.display="none");const s=await c(o,n);e&&(e.style.display="none"),t&&!s&&(t.style.display="block"),l(s)}))},formAutoComplete:(e,t={})=>{const n=JSON.parse(sessionStorage.getItem(o("rep")));if(!n)return null;for(const a in t){const r=e.querySelector(`[name=${a}]`),l=t[a],o=n[l];r&&l&&o&&(r.value=o)}},getLocalRep:()=>JSON.parse(sessionStorage.getItem(o("rep")))};const i=e=>e.reduce(((e,t)=>e+parseInt(t.querySelector("[type=number]").value)),0),u=e=>({[e.querySelector("label").innerText]:e.querySelector("input[type=number]").value}),p=({section:e,inputs:t})=>({[e.querySelector("label").innerText]:t.reduce(((e,t)=>({...e,...u(t)})),{})}),d=(e,t,n,a)=>n===a?(e.value=JSON.stringify((e=>e.reduce(((e,t)=>({...e,...p(t)})),{}))(t)),!0):(e.value=null,!1);var m={sizeForm:({form:e,sizes:t,classes:n,max:a,formInput:r,errCb:l})=>{const o=document.createElement("div");o.setAttribute("class",n.container);const c=t.sections.map((e=>((e,t,n)=>{const a=document.createElement("div");a.setAttribute("class",n.sectionContainer);const r=document.createElement("label");r.setAttribute("class",n.title),r.innerHTML=e;const l=document.createElement("div");l.setAttribute("class",n.inputsContainer);const o=t.map((e=>((e,t)=>{const n=`\n<div class="quantity">\n  <label class="${t}">${e}</label>\n  <input type="button" value="-" class="minus">\n  <input type="number" class="input-text qty text" step="1" min="0" max="" value="0" >\n  <input type="button" value="+" class="plus">\n</div>\n  `,a=document.createElement("DIV");return a.innerHTML=n,a})(e,n.inputLabel)));return o.forEach((e=>l.append(e))),a.append(r),a.append(l),{section:a,inputs:o}})(e,t.sizes,n))),s=c.reduce(((e,t)=>[...e,...t.inputs]),[]);return s.forEach((e=>{const t=e.querySelector("input[value='+']"),n=e.querySelector("input[value='-']"),u=e.querySelector("input[type=number]");n.addEventListener("click",(e=>{let t=i(s);parseInt(u.value)>0&&(u.value=parseInt(u.value)-1,t-=1);const n=d(r,c,t,a);"function"==typeof l&&l(!n,o)})),t.onclick=e=>{e.stopPropagation();const t=i(s)+1;if(t>a)return null;u.value=parseInt(u.value)+1;const n=d(r,c,t,a);"function"==typeof l&&l(!n,o)}})),c.forEach((e=>o.append(e.section))),o}};window.pacifica_geo=({country:e,levels:r}={})=>{if(0===r.length)throw new Error("pacifica_geo: should specified at leat 1 scale level");if(r.length>3)throw new Error("pacifica_geo: should specified max 3 scale levels");var o;r.forEach=e=>{e.select.append(n(e.defaultLabel))},o=r[0],a(o.element,"departments",{country:e,defaultLabel:o.defaultLabel}),r[1]&&(r[0].element.addEventListener("change",t(((t,n)=>r=>{if(!r)return l(n);a(t.element,"cities",{fromId:r,country:e,defaultLabel:t.defaultLabel})})(r[1],r.slice(1)))),r[1].element.append(n(r[1].defaultLabel))),r[2]&&(r[1].element.addEventListener("change",t(((t,n)=>r=>{if(!r)return l(n);a(t.element,"towns",{fromId:r,country:e,defaultLabel:t.defaultLabel})})(r[2],r.slice(2)))),r[2].element.append(n(r[2].defaultLabel)))},window.pacifica_rep=s,window.pacifica_prod=m}();